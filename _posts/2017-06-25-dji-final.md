---
layout:     post
title:      2016 DJI Developper Challenge
date:       2017-06-25 01:00:00
summary:    Oh boy... the most stressful 3 days of my life in recent memory
categories: robotics drones
---
Note: I am now writing thing almost a year later so some of the finer details
have been lost or are a bit fuzzy.

One of the nice things about having the competition in the state of New York
was that we had a logistical advantage in that we just needed to drive down in a few
hours to get to the state of New York. By renting a van, we could also bring all
the equipment we needed including a power supply, a computer screen and a desktop.
One of the guys from Autero screamed "A DESKTOP?!" when he saw us.

As I usually do when I go to competitions, we arrived a day early to attempt to
scope out the site and get a better understanding of what was happening.
Unfortunately for us, the airport is a legitimate airport with security and all
and we couldn't actually go in to inspect the site. The DJI employees were pretty
nice to us and actually gave us some spare parts we needed to fix our GPS mast.
You could feel they really wanted everyone to succeed.

## First practice run

Finally meeting all the teams was awkward at first, it was tough to gauge what
level they were at without seeing their system in action. We were informed that
we would get a single practice run followed by our official run the next day.
We felt this was a bit ridiculous, a single practice run meant you needed everything
functional before you actually got to Rome, NY. You just have to play the hand
you're dealt. I was stressed out to say the least. In fact, you could say I was
pretty close to shitting my pants right there, I couldn't stop pacing around near
our table.

During prep time I had a chance of speaking to Robert Schlub Vice president of R&D
at DJI, who one of the people running the competition. Little did I know that he
used to be director of antenna design at Apple, so I looked pretty ridiculous
coming in with my huge Ubiquity antenna. But he accepted the idea of me installing
it in the truck for our use.

Our turn came up and we were shuttled from the hangar to the test site. We could
finally see the search area. What. The. Fuck. They brought out a fucking Cadillac
and put an AprilTag in it. How the fuck would anyone find that survivor. Most of
the search area seemed pretty legit, from afar we couldn't tell but there was actually
a lot of space between all the objects, enough for a quad to easily navigate around.
Our timer started and we leaped into action, everyone had a very specific task
or thing to setup and we all knew what to do. I was in charge of setting up Wifi,
and I had already all my PoE adapters and access points connected. I go to the
truck and plug in. Nothing happens. I figure out I didn't connect a cable right.
Still nothing. I see my PoE adapter's light keeps flickering. Looks like I'm
overloading the truck and the whole systems shuts down. What the fuck man.

I tell the team what's happening and we attempt to plug our setup at the HQ and
cross our fingers to see if the range holds between HQ, the truck and the search
area. Something still doesn't work. Fuck fuck fuck. We try a bunch of things,
Robert offers us one of his own PoE adapters, in case we had fried ours, we try
piggybacking on DJI's own network, still nothing (I think we might actually
have misheard an IP or something). At some point time is running out but things
seem to be working for us to attempt a run. Alex gets in the truck and goes to
start the run. The truck starts moving and Alex presses the start mission button
in the app... Nothing happens. We were the only team that day who didn't even
take off from the truck. We were beyond disappointed with ourselves.

You see, one of the problems of our system was that we didn't realize we could
configure a network adapter to be always on with a static IP (this is how it's
done on AscTec products). That meant that if our quad didn't have Wifi, it didn't
have an IP address. As a result, ROS would fail to start. In general this wasn't
a problem because we always had network connectivity whenever we tested. But the
whole Wifi fiasco meant a core part of our architecture was missing.

We decided to stay in the hangar and decouple our system from the need for Wifi.
Fortunately for us, Gabriel and his linux skills were of great help. I think we
ended up putting a static IP and setting all ROS scripts to point master to localhost
instead of the Manifold's hostname.

## Practice run 2

We were relieved to learn that DJI would allow all teams a 2nd shorter practice
run. Looked like the practice runs didn't go so well for everyone. I heard
cardinal SAR went straight into a tree.

We decided to use this practice run to attempt to go into the arena. As the truck
starts moving, the M100 shoots up and goes over to the search area. Yes. The M100
lowers down into the area and lands. All good, we had done this to reset the
internal altitude estimator. The M100 takes off and... gets stuck. It seemed like
the place we decided to land was actually between an obstacle and a virtual wall.
The M100 couldn't move. In fact, this problem was something we were always unsure
of. We didn't know where in the search area we could safely descend. One of the things we had investigated was writing a grass detector and descend where there is grass,
i.e. no obstacles. Another was to do a bit of mapping on a small area and try to
descend somewhere far from obstacles. All of this was nice but we hadn't had time
to finish these modules and it turns out that most other teams were doing the same
thing we were and simply picking a GPS coordinate and crossing their fingers. Except
Autero who seemed to enter the arena while also running their obstacle avoidance
module. This irritated me a bit because if you read the rules, the diagrams suggest
that the search area would be surrounded by walls, which led us to believe we had
to come in from the tom.

2nd practice run, wasted.
